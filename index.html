<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Seafoam E‑Card — Guided Demos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ===== base ===== */
    *{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif}
    html{scroll-behavior:smooth}
    body{background:#f0f4f4;color:#333;display:flex;flex-direction:column;min-height:100vh}

    /* ===== header ===== */
    header{display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;background:#A8E6CF;border-bottom:2px solid #82C9A1}
    header h1{font-size:1.5rem;font-weight:700;color:#155f46}
    .pill{background:#60A085;color:#fff;padding:.6rem 1.6rem;border:none;border-radius:9999px;font-weight:600;cursor:pointer;text-decoration:none;transition:.2s}
    .pill:hover{filter:brightness(1.1)}

    /* ===== demos layout ===== */
    main{flex:1;display:flex;flex-direction:column;gap:4rem;padding:2rem 0}
    .demo{width:100%;max-width:1200px;margin:0 auto;background:#fff;border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.1);padding:1.5rem;display:flex;flex-direction:column;align-items:center;position:relative;overflow:hidden}
    .demo h3{margin-bottom:1rem;font-size:1.1rem;font-weight:600;color:#155f46}
    .demo iframe{width:100%;aspect-ratio:16/9;border:2px solid #ccc;border-radius:12px}

    /* pointer */
    #pointer{
      position:fixed;left:0;top:0;width:26px;height:26px;border-radius:50%;
      background:#2a8c60;box-shadow:0 0 0 2px #fff,0 0 6px rgba(0,0,0,.25);
      transform:translate(-50%,-50%);transition:left .7s ease,top .7s ease,transform .15s ease;
      z-index:10000;pointer-events:none
    }
    .clickAnim{transform:translate(-50%,-50%) scale(.5)}

    /* spark for copy */
    .spark{position:absolute;width:8px;height:8px;background:#ffcc00;border-radius:50%;pointer-events:none;animation:spark 1s forwards}
    @keyframes spark{0%{transform:scale(0);opacity:1}80%{transform:scale(1.6);opacity:1}100%{transform:scale(0);opacity:0}}
  </style>
</head>
<body>

  <!-- ===== header ===== -->
  <header>
    <h1>Seafoam E‑Card</h1>
    <a class="pill" href="builder.html">Create E‑Card</a>
  </header>

  <!-- ===== demos ===== -->
  <main>
    <section class="demo" id="demoBuild">
      <h3>1 · Build</h3>
      <iframe id="frameBuild" src="builder.html"></iframe>
    </section>

    <section class="demo" id="demoPreview">
      <h3>2 · Preview</h3>
      <iframe id="framePreview" title="Preview demo"></iframe>
    </section>

    <section class="demo" id="demoShare">
      <h3>3 · Share</h3>
      <iframe id="frameShare" src="builder.html"></iframe>
    </section>
  </main>

  <!-- floating pointer -->
  <div id="pointer"></div>

  <!-- ===== script ===== -->
  <script>
  const delay = ms => new Promise(r=>setTimeout(r,ms));
  const pointer = document.getElementById('pointer');

  /* centre‑of‑element coords converted to page space */
  function globalRect(el){
    let r = el.getBoundingClientRect(), win = el.ownerDocument.defaultView;
    while (win && win !== window){
      const ifr = win.frameElement; if(!ifr) break;
      const ir = ifr.getBoundingClientRect();
      r = {left:r.left+ir.left, top:r.top+ir.top, width:r.width, height:r.height};
      win = ifr.ownerDocument.defaultView;
    }
    return r;
  }

  async function scrollPageTo(el){
    el.scrollIntoView({block:'center',behavior:'smooth'});
    await delay(800);
  }

  async function movePointer(el, extra = 0){
    const r = globalRect(el);
    pointer.style.left = (r.left + r.width/2) + 'px';
    pointer.style.top  = (r.top  + r.height/2) + 'px';
    await delay(700 + extra);
  }

  async function clickPointer(el, synth = true){
    pointer.classList.add('clickAnim');
    if(synth) el.click();
    await delay(150);
    pointer.classList.remove('clickAnim');
  }

  /* sample card content */
  const sample = {
    to:'Sam', from:'Kim',
    lines:['You rock!','Enjoy your day','Dream big','— The Team —'],
    sticker:'https://picsum.photos/120'
  };

  /* ---------- build demo ---------- */
  async function runBuilder(frame){
    await scrollPageTo(document.getElementById('demoBuild'));

    const w = frame.contentWindow, d = w.document;
    if(!d.getElementById('toField')){await delay(200);return runBuilder(frame);}

    const addBtn = d.getElementById('addLine');
    const ul     = d.getElementById('lines');
    [...ul.children].forEach(li=>li.remove());

    for(const txt of sample.lines){
      await movePointer(addBtn);
      await clickPointer(addBtn);
      const inp = ul.lastElementChild.querySelector('input');
      await movePointer(inp);
      inp.value = txt; inp.dispatchEvent(new Event('input',{bubbles:true}));
      await clickPointer(inp,false);
    }

    const toF=d.getElementById('toField'),fromF=d.getElementById('fromField');
    await movePointer(toF); toF.value=sample.to; toF.dispatchEvent(new Event('input',{bubbles:true})); await clickPointer(toF,false);
    await movePointer(fromF); fromF.value=sample.from; fromF.dispatchEvent(new Event('input',{bubbles:true})); await clickPointer(fromF,false);

    const urlF=d.getElementById('stickerUrl');
    await movePointer(urlF); urlF.value=sample.sticker; urlF.dispatchEvent(new Event('input',{bubbles:true})); await clickPointer(urlF,false);

    const gen=d.getElementById('generate');
    await movePointer(gen,200);
    await clickPointer(gen);
    await delay(400);

    return d.getElementById('shareLink').textContent.trim();
  }

  /* ---------- preview demo ---------- */
  async function runPreview(frame){
    await scrollPageTo(document.getElementById('demoPreview'));
    const win = frame.contentWindow, body = win.document.body;
    for(;;){
      win.scrollTo({top:0,behavior:'instant'});
      await delay(200);
      await movePointer(frame);
      win.scrollTo({top:body.scrollHeight,behavior:'smooth'});
      await delay(7500);
    }
  }

  /* ---------- share demo ---------- */
  async function runShare(frame){
    await scrollPageTo(document.getElementById('demoShare'));
    const link = await runBuilder(frame);        // reuse builder steps
    const d = frame.contentWindow.document;
    const copyBtn = d.getElementById('copyBtn');
    await movePointer(copyBtn,150);
    await clickPointer(copyBtn);

    // spark effect (in main page)
    const rect = globalRect(frame);
    const s=document.createElement('div');s.className='spark';
    s.style.left=(rect.left+rect.width*0.8)+'px';
    s.style.top =(rect.top +rect.height*0.2)+'px';
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),1000);

    return link;
  }

  (async()=>{
    const fBuild   = document.getElementById('frameBuild');
    const fPreview = document.getElementById('framePreview');
    const fShare   = document.getElementById('frameShare');

    /* build once, then preview loops */
    const link = await runBuilder(fBuild);

    /* preview loop */
    fPreview.src = link;
    fPreview.onload = ()=>runPreview(fPreview);

    /* share demo loops every 9 s */
    for(;;){
      await runShare(fShare);
      await delay(9000);
      fShare.contentWindow.location.reload();
      await delay(800);
    }
  })();
  </script>
</body>
</html>
